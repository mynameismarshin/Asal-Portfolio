{"version":3,"file":"lamina.cjs.js","sources":["../src/utils/ExportUtils.ts","../src/debug.tsx","../src/index.tsx"],"sourcesContent":["import { SerializedLayer } from 'src/types'\r\nimport * as LAYERS from '../vanilla'\r\n\r\nfunction getPropsFromLayer(layer: SerializedLayer) {\r\n  // @ts-ignore\r\n  const constructor = LAYERS[layer.constructor]\r\n  const instance = new constructor()\r\n  let props = ''\r\n  Object.entries(layer.properties).forEach(([key, val]) => {\r\n    const defaultVal = constructor['u_' + key] ?? instance[key]\r\n\r\n    switch (key) {\r\n      case 'name':\r\n        if (val !== layer.constructor) props += ` ${key}={${JSON.stringify(val)}}`\r\n        break\r\n\r\n      case 'visible':\r\n        if (!val) props += ` ${key}={${JSON.stringify(val)}}`\r\n        break\r\n\r\n      default:\r\n        if (val !== defaultVal) props += ` ${key}={${JSON.stringify(val)}}`\r\n        break\r\n    }\r\n  })\r\n\r\n  return props\r\n}\r\n\r\nexport function serializedLayersToJSX(layers: SerializedLayer[], material: SerializedLayer) {\r\n  const materialProps = getPropsFromLayer(material)\r\n\r\n  const jsx = `\r\n    <LayerMaterial${materialProps}>\r\n      ${layers\r\n        .map((layer) => {\r\n          const props = getPropsFromLayer(layer)\r\n          return `<${layer.constructor}${props} />`\r\n        })\r\n        .join('\\n\\t')}\r\n    </LayerMaterial>\r\n    `\r\n\r\n  return jsx\r\n}\r\n\r\nfunction getJSPropsFromLayer(layer: SerializedLayer) {\r\n  // @ts-ignore\r\n  const constructor = LAYERS[layer.constructor];\r\n  const instance = new constructor();\r\n  let props = '\\t';\r\n  let entries = Object.entries(layer.properties);\r\n  entries.forEach(([key, val], idx) => {\r\n    var _constructor;\r\n    const eol = '\\n\\t\\t';\r\n    if (key.includes('color')) {\r\n      const v = typeof val === \"string\" ? val : '#' + val.getHexString();\r\n      props += `${key}: ${JSON.stringify(v)},${eol}`;\r\n    } else {\r\n      const defaultVal = (_constructor = constructor['u_' + key]) != null ? _constructor : instance[key];\r\n      switch (key) {\r\n        case 'name':\r\n          if (val !== layer.constructor) props += `${key}: ${JSON.stringify(val)},${eol}`;\r\n          break;\r\n          \r\n          case 'visible':\r\n            if (!val) props += `${key}:${JSON.stringify(val)},${eol}`;\r\n            break;\r\n            \r\n          default:\r\n            if (val !== defaultVal) props += `${key}: ${JSON.stringify(val)},${eol}`;\r\n            break;\r\n        }\r\n      }\r\n  });\r\n  return props;\r\n}\r\n\r\nexport function serializedLayersToJS(layers: SerializedLayer[], material: SerializedLayer){\r\n  const materialProps = getJSPropsFromLayer(material);\r\n  const jsLayers = `${layers.map(l => {\r\n    return `new ${l.constructor}({\r\n      ${getJSPropsFromLayer(l)}\r\n      })`\r\n  }).join(',\\n\\t\\t')}`\r\n\r\n  const js = `\r\n  new LayerMaterial({\r\n    ${materialProps}\r\n    layers: [\r\n      ${jsLayers}\r\n    ]\r\n  })`\r\n\r\n  return js;\r\n}\r\n","import { ElementProps, extend } from '@react-three/fiber'\r\nimport { createRoot } from 'react-dom/client'\r\n\r\nimport { button, LevaPanel, useControls, useCreateStore } from 'leva'\r\nimport { DataItem, StoreType } from 'leva/dist/declarations/src/types'\r\nimport React, { useImperativeHandle, useMemo } from 'react'\r\nimport {\r\n  Color,\r\n  MeshBasicMaterial,\r\n  MeshLambertMaterial,\r\n  MeshPhongMaterial,\r\n  MeshPhysicalMaterial,\r\n  MeshStandardMaterial,\r\n  MeshToonMaterial,\r\n  TextureLoader,\r\n} from 'three'\r\nimport { LayerMaterialProps, ShadingTypes } from './types'\r\nimport { serializedLayersToJS, serializedLayersToJSX } from './utils/ExportUtils'\r\nimport { getLayerMaterialArgs, getUniform } from './utils/Functions'\r\nimport * as LAYERS from './vanilla'\r\n\r\nextend({\r\n  LayerMaterial: LAYERS.LayerMaterial,\r\n})\r\n\r\nfunction DynamicLeva({\r\n  name,\r\n  layers,\r\n  store,\r\n  setUpdate,\r\n}: {\r\n  setUpdate: any\r\n  name: string\r\n  layers: any[]\r\n  store: StoreType\r\n}) {\r\n  useControls(\r\n    name,\r\n    () => {\r\n      const o: any = {}\r\n      layers.forEach((layer, i: number) => {\r\n        const n = `${layer.label} ~${i}`\r\n        o[n] = layer\r\n        o[n].onChange = () => setUpdate([`${name}.${n}`, layer.label])\r\n      })\r\n      return o\r\n    },\r\n    { store },\r\n    [layers, name]\r\n  )\r\n\r\n  return null\r\n}\r\n\r\ntype AllMaterialProps = ElementProps<typeof MeshPhongMaterial> & //\r\n  ElementProps<typeof MeshPhysicalMaterial> &\r\n  ElementProps<typeof MeshToonMaterial> &\r\n  ElementProps<typeof MeshBasicMaterial> &\r\n  ElementProps<typeof MeshLambertMaterial> &\r\n  ElementProps<typeof MeshStandardMaterial>\r\n\r\nconst DebugLayerMaterial = React.forwardRef<\r\n  LAYERS.LayerMaterial,\r\n  React.PropsWithChildren<LayerMaterialProps & Omit<AllMaterialProps, 'color'>>\r\n>(({ children, ...props }, forwardRef) => {\r\n  const ref = React.useRef<\r\n    LAYERS.LayerMaterial & {\r\n      [key: string]: any\r\n    }\r\n  >(null!)\r\n  useImperativeHandle(forwardRef, () => ref.current)\r\n  const store = useCreateStore()\r\n  const [layers, setLayers] = React.useState<{ [name: string]: any[] }>({})\r\n  const [path, setPath] = React.useState(['', ''])\r\n  const textureLoader = useMemo(() => new TextureLoader(), [])\r\n\r\n  useControls(\r\n    {\r\n      'Copy JSX': button(() => {\r\n        const serialized = ref.current.layers.map((l) => l.serialize())\r\n        const jsx = serializedLayersToJSX(serialized, ref.current.serialize())\r\n        navigator.clipboard.writeText(jsx)\r\n      }),\r\n      'Copy JS': button(() => {\r\n        const serialized = ref.current.layers.map((l) => l.serialize())\r\n        const js = serializedLayersToJS(serialized, ref.current.serialize())\r\n        navigator.clipboard.writeText(js)\r\n      }),\r\n    },\r\n    { store }\r\n  )\r\n\r\n  const { Lighting } = useControls(\r\n    'Base',\r\n    {\r\n      Color: {\r\n        value: '#' + new Color(ref.current?.color || props?.color || 'white').convertLinearToSRGB().getHexString(),\r\n        onChange: (v) => {\r\n          ref.current.color = v\r\n        },\r\n      },\r\n      Alpha: {\r\n        value: ref.current?.alpha || props?.alpha || 1,\r\n        min: 0,\r\n        max: 1,\r\n        onChange: (v) => {\r\n          ref.current.alpha = v\r\n        },\r\n      },\r\n      Lighting: {\r\n        value: ref.current?.lighting || props?.lighting || 'basic',\r\n        options: Object.keys(ShadingTypes),\r\n      },\r\n    },\r\n    { store }\r\n  )\r\n  const [args, otherProps] = useMemo(() => getLayerMaterialArgs({ ...props, lighting: Lighting }), [props, Lighting])\r\n\r\n  React.useEffect(() => {\r\n    const layers = ref.current.layers\r\n\r\n    const schema: { [name: string]: any[] } = {}\r\n    layers.forEach((layer: any, i: number) => {\r\n      if (layer.getSchema) schema[`${layer.name} ~${i}`] = layer.getSchema()\r\n    })\r\n\r\n    setLayers(schema)\r\n  }, [children])\r\n\r\n  React.useEffect(() => {\r\n    const data = store.getData()\r\n    const updatedData = data[path[0]] as DataItem & {\r\n      value: any\r\n    }\r\n    if (updatedData) {\r\n      const split = path[0].split('.')\r\n      const index = parseInt(split[0].split(' ~')[1])\r\n      const property = path[1]\r\n      const id = ref.current.layers[index].uuid\r\n      const uniform = ref.current.uniforms[`u_${id}_${property}`]\r\n      const layer = ref.current.layers[index] as LAYERS.Abstract & {\r\n        [key: string]: any\r\n      }\r\n\r\n      if (property !== 'map') {\r\n        layer[property] = updatedData.value\r\n        if (uniform) {\r\n          uniform.value = getUniform(updatedData.value)\r\n        } else {\r\n          layer.buildShaders(layer.constructor)\r\n          ref.current.refresh()\r\n        }\r\n      } else {\r\n        ;(async () => {\r\n          try {\r\n            if (updatedData.value) {\r\n              const t = await textureLoader.loadAsync(updatedData.value)\r\n              layer[property] = t\r\n              uniform.value = t\r\n            } else {\r\n              layer[property] = undefined\r\n              uniform.value = undefined\r\n            }\r\n          } catch (error) {\r\n            console.error(error)\r\n          }\r\n        })()\r\n      }\r\n    }\r\n  }, [path])\r\n\r\n  React.useLayoutEffect(() => {\r\n    ref.current.layers = (ref.current as any).__r3f.children?.map((l: any) => l.object)\r\n    ref.current.refresh()\r\n  }, [children, args])\r\n\r\n  React.useLayoutEffect(() => {\r\n    const root = document.body.querySelector('#root')\r\n    const div = document.createElement('div')\r\n\r\n    if (root) {\r\n      root.appendChild(div)\r\n      const levaRoot = createRoot(div)\r\n      levaRoot.render(\r\n        <LevaPanel\r\n          titleBar={{\r\n            title: props.name || ref.current.name,\r\n          }}\r\n          store={store}\r\n        />\r\n      )\r\n    }\r\n\r\n    return () => {\r\n      div.remove()\r\n    }\r\n  }, [props.name])\r\n\r\n  return (\r\n    <>\r\n      {Object.entries(layers).map(([name, layers], i) => (\r\n        <DynamicLeva key={`${name} ~${i}`} name={name} layers={layers} store={store} setUpdate={setPath} />\r\n      ))}\r\n      <layerMaterial args={[args]} ref={ref} {...otherProps}>\r\n        {children}\r\n      </layerMaterial>\r\n    </>\r\n  )\r\n})\r\n\r\nexport default DebugLayerMaterial\r\n","import { ElementProps, extend, ThreeElement } from '@react-three/fiber'\r\nimport React, { useImperativeHandle, useMemo } from 'react'\r\nimport {\r\n  MeshBasicMaterial,\r\n  MeshLambertMaterial,\r\n  MeshPhongMaterial,\r\n  MeshPhysicalMaterial,\r\n  MeshStandardMaterial,\r\n  MeshToonMaterial,\r\n} from 'three'\r\nimport DebugLayerMaterial from './debug'\r\nimport {\r\n  ColorProps,\r\n  DepthProps,\r\n  DisplaceProps,\r\n  FresnelProps,\r\n  GradientProps,\r\n  LayerMaterialProps,\r\n  MatcapProps,\r\n  NoiseProps,\r\n  NormalProps,\r\n  TextureProps,\r\n} from './types'\r\nimport { getLayerMaterialArgs } from './utils/Functions'\r\nimport * as LAYERS from './vanilla'\r\n\r\ndeclare module '@react-three/fiber' {\r\n  interface ThreeElements {\r\n    layerMaterial: ThreeElement<typeof LAYERS.LayerMaterial>\r\n    depth_: ThreeElement<typeof LAYERS.Depth>\r\n    color_: ThreeElement<typeof LAYERS.Color>\r\n    noise_: ThreeElement<typeof LAYERS.Noise>\r\n    fresnel_: ThreeElement<typeof LAYERS.Fresnel>\r\n    gradient_: ThreeElement<typeof LAYERS.Gradient>\r\n    matcap_: ThreeElement<typeof LAYERS.Matcap>\r\n    texture_: ThreeElement<typeof LAYERS.Texture>\r\n    displace_: ThreeElement<typeof LAYERS.Displace>\r\n    normal_: ThreeElement<typeof LAYERS.Normal>\r\n  }\r\n}\r\n\r\nextend({\r\n  LayerMaterial: LAYERS.LayerMaterial,\r\n  Depth_: LAYERS.Depth,\r\n  Color_: LAYERS.Color,\r\n  Noise_: LAYERS.Noise,\r\n  Fresnel_: LAYERS.Fresnel,\r\n  Gradient_: LAYERS.Gradient,\r\n  Matcap_: LAYERS.Matcap,\r\n  Texture_: LAYERS.Texture,\r\n  Displace_: LAYERS.Displace,\r\n  Normal_: LAYERS.Normal,\r\n})\r\n\r\nexport type AllMaterialProps = ElementProps<typeof MeshPhongMaterial> & //\r\n  ElementProps<typeof MeshPhysicalMaterial> &\r\n  ElementProps<typeof MeshToonMaterial> &\r\n  ElementProps<typeof MeshBasicMaterial> &\r\n  ElementProps<typeof MeshLambertMaterial> &\r\n  ElementProps<typeof MeshStandardMaterial>\r\n\r\nconst LayerMaterial = React.forwardRef<\r\n  LAYERS.LayerMaterial,\r\n  React.PropsWithChildren<LayerMaterialProps & Omit<AllMaterialProps, 'color'>>\r\n>(({ children, ...props }, forwardRef) => {\r\n  const ref = React.useRef<LAYERS.LayerMaterial>(null!)\r\n  useImperativeHandle(forwardRef, () => ref.current)\r\n\r\n  React.useLayoutEffect(() => {\r\n    ref.current.layers = (ref.current as any).__r3f.children?.map((l: any) => l.object)\r\n    ref.current.refresh()\r\n  }, [children])\r\n\r\n  const [args, otherProps] = useMemo(() => getLayerMaterialArgs(props), [props])\r\n\r\n  return (\r\n    <layerMaterial args={[args]} ref={ref} {...otherProps}>\r\n      {children}\r\n    </layerMaterial>\r\n  )\r\n})\r\n\r\nfunction getNonUniformArgs(props: any) {\r\n  return [\r\n    {\r\n      mode: props?.mode,\r\n      visible: props?.visible,\r\n      type: props?.type,\r\n      mapping: props?.mapping,\r\n      map: props?.map,\r\n      axes: props?.axes,\r\n    },\r\n  ] as any\r\n}\r\n\r\nconst Depth = React.forwardRef<LAYERS.Depth, DepthProps>((props, forwardRef) => {\r\n  //@ts-ignore\r\n  return <depth_ args={getNonUniformArgs(props)} ref={forwardRef} {...props} />\r\n}) as React.ForwardRefExoticComponent<DepthProps & React.RefAttributes<LAYERS.Depth>>\r\n\r\nconst Color = React.forwardRef<LAYERS.Color, ColorProps>((props, ref) => {\r\n  //@ts-ignore\r\n  return <color_ ref={ref} args={getNonUniformArgs(props)} {...props} />\r\n}) as React.ForwardRefExoticComponent<ColorProps & React.RefAttributes<LAYERS.Color>>\r\n\r\nconst Noise = React.forwardRef<LAYERS.Noise, NoiseProps>((props, ref) => {\r\n  //@ts-ignore\r\n  return <noise_ ref={ref} args={getNonUniformArgs(props)} {...props} />\r\n}) as React.ForwardRefExoticComponent<NoiseProps & React.RefAttributes<LAYERS.Noise>>\r\n\r\nconst Fresnel = React.forwardRef<LAYERS.Fresnel, FresnelProps>((props, ref) => {\r\n  //@ts-ignore\r\n  return <fresnel_ ref={ref} args={getNonUniformArgs(props)} {...props} />\r\n}) as React.ForwardRefExoticComponent<FresnelProps & React.RefAttributes<LAYERS.Fresnel>>\r\n\r\nconst Gradient = React.forwardRef<LAYERS.Gradient, GradientProps>((props, ref) => {\r\n  //@ts-ignore\r\n  return <gradient_ ref={ref} args={getNonUniformArgs(props)} {...props} />\r\n}) as React.ForwardRefExoticComponent<GradientProps & React.RefAttributes<LAYERS.Gradient>>\r\n\r\nconst Matcap = React.forwardRef<LAYERS.Matcap, MatcapProps>((props, ref) => {\r\n  //@ts-ignore\r\n  return <matcap_ ref={ref} args={getNonUniformArgs(props)} {...props} />\r\n}) as React.ForwardRefExoticComponent<MatcapProps & React.RefAttributes<LAYERS.Matcap>>\r\n\r\nconst Texture = React.forwardRef<LAYERS.Texture, TextureProps>((props, ref) => {\r\n  //@ts-ignore\r\n  return <texture_ ref={ref} args={getNonUniformArgs(props)} {...props} />\r\n}) as React.ForwardRefExoticComponent<TextureProps & React.RefAttributes<LAYERS.Texture>>\r\n\r\nconst Displace = React.forwardRef<LAYERS.Displace, DisplaceProps>((props, ref) => {\r\n  //@ts-ignore\r\n  return <displace_ ref={ref} args={getNonUniformArgs(props)} {...props} />\r\n}) as React.ForwardRefExoticComponent<DisplaceProps & React.RefAttributes<LAYERS.Displace>>\r\n\r\nconst Normal = React.forwardRef<LAYERS.Normal, NormalProps>((props, ref) => {\r\n  //@ts-ignore\r\n  return <normal_ ref={ref} args={getNonUniformArgs(props)} {...props} />\r\n}) as React.ForwardRefExoticComponent<NormalProps & React.RefAttributes<LAYERS.Normal>>\r\n\r\nexport { Color, DebugLayerMaterial, Depth, Displace, Fresnel, Gradient, LayerMaterial, Matcap, Noise, Normal, Texture }\r\n"],"names":["getPropsFromLayer","layer","constructor","LAYERS","instance","props","key","val","defaultVal","serializedLayersToJSX","layers","material","getJSPropsFromLayer","idx","_constructor","eol","v","serializedLayersToJS","materialProps","jsLayers","l","extend","LAYERS.LayerMaterial","DynamicLeva","name","store","setUpdate","useControls","o","i","n","DebugLayerMaterial","React","children","forwardRef","ref","useImperativeHandle","useCreateStore","setLayers","path","setPath","textureLoader","useMemo","TextureLoader","button","serialized","jsx","js","Lighting","Color","_a","_b","_c","ShadingTypes","args","otherProps","getLayerMaterialArgs","schema","updatedData","split","index","property","id","uniform","getUniform","t","error","root","div","createRoot","LevaPanel","jsxs","Fragment","LAYERS.Depth","LAYERS.Color","LAYERS.Noise","LAYERS.Fresnel","LAYERS.Gradient","LAYERS.Matcap","LAYERS.Texture","LAYERS.Displace","LAYERS.Normal","LayerMaterial","getNonUniformArgs","Depth","Noise","Fresnel","Gradient","Matcap","Texture","Displace","Normal"],"mappings":"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"}